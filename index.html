<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>inginiaOS LITE ‚Äì Connect Notion</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root{
      --brand:#111827;          /* almost-black */
      --accent:#10B981;         /* green (trust) */
      --bg:#F8FAFC;             /* soft background */
      --card:#FFFFFF;
      --muted:#6B7280;          /* gray-500 */
      --ring:#E5E7EB;           /* gray-200 */
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,#F8FAFC 0%, #EEF2F7 100%);
      color:var(--brand);
    }
    .wrap{
      min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:28px;
    }
    .card{
      width:100%; max-width:540px; background:var(--card);
      border:1px solid var(--ring); border-radius:16px; padding:28px;
      box-shadow:0 10px 30px rgba(17,24,39,.06);
    }
    .brand{
      display:flex; align-items:center; gap:12px; margin-bottom:18px;
    }
    .logo{
      width:44px; height:44px; border-radius:10px; background:var(--brand); display:grid; place-items:center; color:#fff; font-weight:700;
      letter-spacing:.5px;
    }
    .title{ font-size:22px; font-weight:700; }
    .subtitle{ color:var(--muted); margin:6px 0 18px }
    .badge{
      display:inline-block; background:#ECFDF5; color:#064E3B; border:1px solid #D1FAE5;
      padding:6px 10px; border-radius:999px; font-size:12px; font-weight:600; margin-bottom:12px;
    }
    .btn{
      width:100%; display:inline-flex; align-items:center; justify-content:center; gap:10px;
      appearance:none; border:0; border-radius:12px; padding:14px 18px; font-weight:700;
      background:var(--accent); color:#fff; cursor:pointer; transition:transform .05s ease, filter .2s ease;
      box-shadow:0 8px 20px rgba(16,185,129,.25);
    }
    .btn:hover{ filter:brightness(1.05) }
    .btn:active{ transform:translateY(1px) }
    .hint{ color:var(--muted); font-size:13px; margin-top:10px }
    .trust{
      display:flex; gap:16px; align-items:center; margin-top:18px; color:var(--muted); font-size:13px;
    }
    .dot{ width:6px; height:6px; background:#10B981; border-radius:50% }
    .footer{ margin-top:22px; font-size:12px; color:var(--muted) }
    .sep{ height:1px; background:var(--ring); margin:18px 0 }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="brand">
        <div class="logo">iL</div>
        <div>
          <div class="title">inginiaOS LITE</div>
          <div class="subtitle">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ö‡∏≠‡∏ó‡∏Å‡∏±‡∏ö Notion ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
        </div>
      </div>

      <span class="badge">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ¬∑ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏î‡πâ‡∏ß‡∏¢ OAuth</span>

      <button class="btn" id="connectBtn">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Notion</button>
      <div class="hint">‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏ú‡πà‡∏≤‡∏ô LINE ‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Ç‡∏≠‡∏á Notion</div>

      <div class="sep"></div>

      <div class="trust">
        <div class="dot"></div><div>‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (Least privilege)</div>
        <div class="dot"></div><div>‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ô Notion ‚Üí Settings ‚Üí Connections</div>
      </div>

      <div class="footer">¬© inginiaOS LITE</div>
    </div>
  </div>

  <!-- LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    const LIFF_ID = "2007908663-x5w4P5e8";
    const NOTION_CLIENT_ID = "292d872b-594c-8084-b197-0037706efd54";
    const REDIRECT_URI = "https://hook.eu2.make.com/ct4w4kb9i18cxda4zj4tv1y8w34gdzxx";

    async function getLineUserId() {
      await liff.init({ liffId: LIFF_ID });

      // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Mobile (in-app) ‡πÅ‡∏•‡∏∞ PC (‡πÉ‡∏´‡πâ login LINE Web ‡∏Å‡πà‡∏≠‡∏ô)
      if (!liff.isInClient() && !liff.isLoggedIn()) {
        liff.login({ redirectUri: window.location.href });
        return null; // ‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏±‡∏á login
      }
      const profile = await liff.getProfile();
      return profile.userId; // ‡πÄ‡∏ä‡πà‡∏ô "Uxxxxxxxxxxxxxxxxxxxx"
    }

    async function connectNotion() {
      try {
        const lineId = await getLineUserId();
        if (!lineId) return;

        const oauthUrl =
          "https://api.notion.com/v1/oauth/authorize" +
          "?client_id=" + encodeURIComponent(NOTION_CLIENT_ID) +
          "&response_type=code" +
          "&owner=user" +
          "&redirect_uri=" + encodeURIComponent(REDIRECT_URI) +
          "&state=" + encodeURIComponent(lineId);

        // ‡∏™‡πà‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Ç‡∏≠‡∏á Notion
        liff.openWindow({ url: oauthUrl, external: true });
      } catch (err) {
        alert("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ\n" + (err?.message || err));
        console.error(err);
      }
    }

    document.getElementById("connectBtn").addEventListener("click", connectNotion);
  </script>
</body>
</html>
